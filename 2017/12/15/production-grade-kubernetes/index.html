<!DOCTYPE html><html><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><link rel="preload" href="/component---src-layouts-index-js-bb0078f6fed199dc13ad.js" as="script"/><link rel="preload" href="/component---src-templates-blog-post-js-036753d74d89fd51a17f.js" as="script"/><link rel="preload" href="/path---2017-12-15-production-grade-kubernetes-1d4543bbf55aba20ee23.js" as="script"/><link rel="preload" href="/app-25f1fe20b777aed8076d.js" as="script"/><link rel="preload" href="/commons-3cf304937523a964e309.js" as="script"/><link rel="alternate" type="application/rss+xml" href="/rss.xml"/><title data-react-helmet="true">Production Grade Kubernetes | 5π - fish&#x27;s blog</title><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:100%/1.75em 'Merriweather','Georgia',serif;box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.9);font-family:'Merriweather','Georgia',serif;font-weight:400;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}h1{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:Montserrat,sans-serif;font-weight:900;text-rendering:optimizeLegibility;font-size:2.5rem;line-height:1.1;}h2{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:1.73286rem;line-height:1.1;}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:1.4427rem;line-height:1.1;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.1;letter-spacing:0.140625em;text-transform:uppercase;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:0.83255rem;line-height:1.1;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:0.75966rem;line-height:1.1;font-style:italic;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}ul{margin-left:1.75rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;list-style-position:outside;list-style-image:none;list-style:disc;}ol{margin-left:1.75rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;font-size:0.85rem;line-height:1.75rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;font-size:1rem;line-height:1.75rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}blockquote{margin-left:-1.75rem;margin-right:1.75rem;margin-top:0;padding-bottom:0;padding-left:1.42188rem;padding-right:0;padding-top:0;margin-bottom:1.75rem;font-size:1.20112rem;line-height:1.75rem;color:hsla(0,0%,0%,0.59);font-style:italic;border-left:0.32813rem solid hsla(0,0%,0%,0.9);}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(1.75rem - 1px);background:hsla(0,0%,0%,0.2);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}b{font-weight:700;}strong{font-weight:700;}dt{font-weight:700;}th{font-weight:700;}li{margin-bottom:calc(1.75rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.75rem;margin-bottom:calc(1.75rem / 2);margin-top:calc(1.75rem / 2);}li > ul{margin-left:1.75rem;margin-bottom:calc(1.75rem / 2);margin-top:calc(1.75rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:calc(1.75rem / 2);}code{font-size:0.85rem;line-height:1.75rem;}kbd{font-size:0.85rem;line-height:1.75rem;}samp{font-size:0.85rem;line-height:1.75rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:1.16667rem;padding-right:1.16667rem;padding-top:0.875rem;padding-bottom:calc(0.875rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}blockquote > :last-child{margin-bottom:0;}blockquote cite{font-size:1rem;line-height:1.75rem;color:hsla(0,0%,0%,0.9);font-weight:400;}blockquote cite:before{content:"— ";}ul,ol{margin-left:0;}@media only screen and (max-width:480px){ul,ol{margin-left:1.75rem;}blockquote{margin-left:-1.3125rem;margin-right:0;padding-left:0.98438rem;}}h1,h2,h3,h4,h5,h6{margin-top:3.5rem;}a{box-shadow:0 1px 0 0 currentColor;color:#007acc;text-decoration:none;}a:hover,a:active{box-shadow:none;}mark,ins{background:#007acc;color:white;padding:0.10938rem 0.21875rem;text-decoration:none;}a.gatsby-resp-image-link{box-shadow:none;}</style><style id="gatsby-inlined-css">@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:100;src:local("Montserrat Thin "),local("Montserrat-Thin"),url(/static/montserrat-latin-100.50d27986.woff2) format("woff2"),url(/static/montserrat-latin-100.5e334eff.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:100;src:local("Montserrat Thin italic"),local("Montserrat-Thinitalic"),url(/static/montserrat-latin-100italic.8c070533.woff2) format("woff2"),url(/static/montserrat-latin-100italic.03e19243.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:200;src:local("Montserrat Extra Light "),local("Montserrat-Extra Light"),url(/static/montserrat-latin-200.4343d3d9.woff2) format("woff2"),url(/static/montserrat-latin-200.f2022ecd.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:200;src:local("Montserrat Extra Light italic"),local("Montserrat-Extra Lightitalic"),url(/static/montserrat-latin-200italic.116c4c4b.woff2) format("woff2"),url(/static/montserrat-latin-200italic.89614a60.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:300;src:local("Montserrat Light "),local("Montserrat-Light"),url(/static/montserrat-latin-300.d2ad295b.woff2) format("woff2"),url(/static/montserrat-latin-300.3a371ee0.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:300;src:local("Montserrat Light italic"),local("Montserrat-Lightitalic"),url(/static/montserrat-latin-300italic.f6b6bf24.woff2) format("woff2"),url(/static/montserrat-latin-300italic.16521668.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:400;src:local("Montserrat Regular "),local("Montserrat-Regular"),url(/static/montserrat-latin-400.240a8444.woff2) format("woff2"),url(/static/montserrat-latin-400.b20cc131.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:400;src:local("Montserrat Regular italic"),local("Montserrat-Regularitalic"),url(/static/montserrat-latin-400italic.86172bb8.woff2) format("woff2"),url(/static/montserrat-latin-400italic.9405e787.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:500;src:local("Montserrat Medium "),local("Montserrat-Medium"),url(/static/montserrat-latin-500.fb8d6b71.woff2) format("woff2"),url(/static/montserrat-latin-500.50825d47.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:500;src:local("Montserrat Medium italic"),local("Montserrat-Mediumitalic"),url(/static/montserrat-latin-500italic.c0a555a4.woff2) format("woff2"),url(/static/montserrat-latin-500italic.635de59c.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:600;src:local("Montserrat SemiBold "),local("Montserrat-SemiBold"),url(/static/montserrat-latin-600.d5615136.woff2) format("woff2"),url(/static/montserrat-latin-600.f300da4f.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:600;src:local("Montserrat SemiBold italic"),local("Montserrat-SemiBolditalic"),url(/static/montserrat-latin-600italic.10f29d13.woff2) format("woff2"),url(/static/montserrat-latin-600italic.2bc37d86.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:700;src:local("Montserrat Bold "),local("Montserrat-Bold"),url(/static/montserrat-latin-700.7d77e1f0.woff2) format("woff2"),url(/static/montserrat-latin-700.81826529.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:700;src:local("Montserrat Bold italic"),local("Montserrat-Bolditalic"),url(/static/montserrat-latin-700italic.1dd2b53f.woff2) format("woff2"),url(/static/montserrat-latin-700italic.c162d257.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:800;src:local("Montserrat ExtraBold "),local("Montserrat-ExtraBold"),url(/static/montserrat-latin-800.d4e7bf86.woff2) format("woff2"),url(/static/montserrat-latin-800.895aadbf.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:800;src:local("Montserrat ExtraBold italic"),local("Montserrat-ExtraBolditalic"),url(/static/montserrat-latin-800italic.fc0cbe44.woff2) format("woff2"),url(/static/montserrat-latin-800italic.b3362875.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:900;src:local("Montserrat Black "),local("Montserrat-Black"),url(/static/montserrat-latin-900.c8bdd772.woff2) format("woff2"),url(/static/montserrat-latin-900.1b99ef78.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:900;src:local("Montserrat Black italic"),local("Montserrat-Blackitalic"),url(/static/montserrat-latin-900italic.cb72c1f9.woff2) format("woff2"),url(/static/montserrat-latin-900italic.b78bb9f8.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:300;src:local("Merriweather Light "),local("Merriweather-Light"),url(/static/merriweather-latin-300.f015f1e9.woff2) format("woff2"),url(/static/merriweather-latin-300.92dfe81b.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:300;src:local("Merriweather Light italic"),local("Merriweather-Lightitalic"),url(/static/merriweather-latin-300italic.7fd86b32.woff2) format("woff2"),url(/static/merriweather-latin-300italic.878b76f5.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:400;src:local("Merriweather Regular "),local("Merriweather-Regular"),url(/static/merriweather-latin-400.12dbf4c0.woff2) format("woff2"),url(/static/merriweather-latin-400.1fffad22.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:400;src:local("Merriweather Regular italic"),local("Merriweather-Regularitalic"),url(/static/merriweather-latin-400italic.1e0d3e81.woff2) format("woff2"),url(/static/merriweather-latin-400italic.de18d4c4.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:700;src:local("Merriweather Bold "),local("Merriweather-Bold"),url(/static/merriweather-latin-700.dc8fec81.woff2) format("woff2"),url(/static/merriweather-latin-700.d7d2ed8e.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:700;src:local("Merriweather Bold italic"),local("Merriweather-Bolditalic"),url(/static/merriweather-latin-700italic.b7b7e5da.woff2) format("woff2"),url(/static/merriweather-latin-700italic.6210a5fc.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:900;src:local("Merriweather Black "),local("Merriweather-Black"),url(/static/merriweather-latin-900.43f870d5.woff2) format("woff2"),url(/static/merriweather-latin-900.8f3806df.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:900;src:local("Merriweather Black italic"),local("Merriweather-Blackitalic"),url(/static/merriweather-latin-900italic.168c1ab2.woff2) format("woff2"),url(/static/merriweather-latin-900italic.ae7778f0.woff) format("woff")}@font-face{font-family:fontello;src:url(/static/fontello.1f1e37ad.eot);src:url(/static/fontello.1f1e37ad.eot#iefix) format("embedded-opentype"),url(/static/fontello.c83454bd.woff2) format("woff2"),url(/static/fontello.a05a3791.woff) format("woff"),url(/static/fontello.cec4b829.ttf) format("truetype"),url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/Pgo8IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPgo8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxtZXRhZGF0YT5Db3B5cmlnaHQgKEMpIDIwMTcgYnkgb3JpZ2luYWwgYXV0aG9ycyBAIGZvbnRlbGxvLmNvbTwvbWV0YWRhdGE+CjxkZWZzPgo8Zm9udCBpZD0iZm9udGVsbG8iIGhvcml6LWFkdi14PSIxMDAwIiA+Cjxmb250LWZhY2UgZm9udC1mYW1pbHk9ImZvbnRlbGxvIiBmb250LXdlaWdodD0iNDAwIiBmb250LXN0cmV0Y2g9Im5vcm1hbCIgdW5pdHMtcGVyLWVtPSIxMDAwIiBhc2NlbnQ9Ijg1MCIgZGVzY2VudD0iLTE1MCIgLz4KPG1pc3NpbmctZ2x5cGggaG9yaXotYWR2LXg9IjEwMDAiIC8+CjxnbHlwaCBnbHlwaC1uYW1lPSJ0d2l0dGVyIiB1bmljb2RlPSImI3hmMDk5OyIgZD0iTTkwNCA2MjJxLTM3LTU0LTkwLTkzIDAtOCAwLTIzIDAtNzMtMjEtMTQ1dC02NC0xMzktMTAzLTExNy0xNDQtODItMTgxLTMwcS0xNTEgMC0yNzYgODEgMTktMiA0My0yIDEyNiAwIDIyNCA3Ny01OSAxLTEwNSAzNnQtNjQgODlxMTktMyAzNC0zIDI0IDAgNDggNi02MyAxMy0xMDQgNjJ0LTQxIDExNXYycTM4LTIxIDgyLTIzLTM3IDI1LTU5IDY0dC0yMiA4NnEwIDQ5IDI1IDkxIDY4LTgzIDE2NC0xMzN0MjA4LTU1cS01IDIxLTUgNDEgMCA3NSA1MyAxMjd0MTI3IDUzcTc5IDAgMTMyLTU3IDYxIDEyIDExNSA0NC0yMS02NC04MC0xMDAgNTIgNiAxMDQgMjh6IiBob3Jpei1hZHYteD0iOTI4LjYiIC8+Cgo8Z2x5cGggZ2x5cGgtbmFtZT0iZ2l0aHViLWNpcmNsZWQiIHVuaWNvZGU9IiYjeGYwOWI7IiBkPSJNNDI5IDc3OXExMTYgMCAyMTUtNTh0MTU2LTE1NiA1Ny0yMTVxMC0xNDAtODItMjUydC0yMTEtMTU1cS0xNS0zLTIyIDR0LTcgMTdxMCAxIDAgNDN0MCA3NXEwIDU0LTI5IDc5IDMyIDMgNTcgMTB0NTMgMjIgNDUgMzcgMzAgNTggMTEgODRxMCA2Ny00NCAxMTUgMjEgNTEtNCAxMTQtMTYgNS00Ni02dC01MS0yNWwtMjEtMTNxLTUyIDE1LTEwNyAxNXQtMTA4LTE1cS04IDYtMjMgMTV0LTQ3IDIyLTQ3IDdxLTI1LTYzLTUtMTE0LTQ0LTQ4LTQ0LTExNSAwLTQ3IDEyLTgzdDI5LTU5IDQ1LTM3IDUyLTIyIDU3LTEwcS0yMS0yMC0yNy01OC0xMi01LTI1LTh0LTMyLTMtMzYgMTItMzEgMzVxLTExIDE4LTI3IDI5dC0yOCAxNGwtMTEgMXEtMTIgMC0xNi0ydC0zLTcgNS04IDctNmw0LTNxMTItNiAyNC0yMXQxOC0yOWw2LTEzcTctMjEgMjQtMzR0MzctMTcgMzktMyAzMSAxbDEzIDNxMC0yMiAwLTUwdDEtMzBxMC0xMC04LTE3dC0yMi00cS0xMjkgNDMtMjExIDE1NXQtODIgMjUycTAgMTE3IDU4IDIxNXQxNTUgMTU2IDIxNiA1OHogbS0yNjctNjE2cTIgNC0zIDctNiAxLTgtMS0xLTQgNC03IDUtMyA3IDF6IG0xOC0xOXE0IDMtMSA5LTYgNS05IDItNC0zIDEtOSA1LTYgOS0yeiBtMTYtMjVxNiA0IDAgMTEtNCA3LTkgMy01LTMgMC0xMHQ5LTR6IG0yNC0yM3E0IDQtMiAxMC03IDctMTEgMi01LTUgMi0xMSA2LTYgMTEtMXogbTMyLTE0cTEgNi04IDktOCAyLTEwLTR0Ny05cTgtMyAxMSA0eiBtMzUtM3EwIDctMTAgNi05IDAtOS02IDAtNyAxMC02IDkgMCA5IDZ6IG0zMiA1cS0xIDctMTAgNS05LTEtOC04dDEwLTQgOCA3eiIgaG9yaXotYWR2LXg9Ijg1Ny4xIiAvPgoKPGdseXBoIGdseXBoLW5hbWU9ImZhY2Vib29rLW9mZmljaWFsIiB1bmljb2RlPSImI3hmMjMwOyIgZD0iTTgxMCA3NzlxMTkgMCAzMy0xNHQxNC0zNHYtNzYycTAtMjAtMTQtMzR0LTMzLTE0aC0yMTh2MzMzaDExMWwxNiAxMjloLTEyN3Y4M3EwIDMxIDEzIDQ2dDUxIDE2bDY4IDF2MTE1cS0zNSA1LTEwMCA1LTc1IDAtMTIxLTQ0dC00NS0xMjd2LTk1aC0xMTJ2LTEyOWgxMTJ2LTMzM2gtNDExcS0xOSAwLTMzIDE0dC0xNCAzNHY3NjJxMCAyMCAxNCAzNHQzMyAxNGg3NjN6IiBob3Jpei1hZHYteD0iODU3LjEiIC8+Cgo8Z2x5cGggZ2x5cGgtbmFtZT0iZ2l0aHViLXNxdWFyZWQiIHVuaWNvZGU9IiYjeGYzMDA7IiBkPSJNMjkwIDE4MHEyIDQtMiA4LTUgNC04IDEtMi00IDItNyA1LTQgOC0yeiBtLTE2IDIzcS0zIDQtNyAzLTMtMyAwLTcgNC01IDctMyAzIDIgMCA3eiBtLTIzIDIzcTEgMi0zIDQtNCAxLTQtMS0yLTMgMi01IDUtMSA1IDJ6IG0xMi0xM3ExIDAgMSAydC0yIDNxLTQgNC02IDJ0MS02cTMtMyA2LTF6IG00OC00MnExIDQtNSA2LTUgMi03LTItMi00IDUtNiA1LTIgNyAyeiBtMjMtMnEwIDUtNiA1LTYgMC02LTV0Ni00IDYgNHogbTIyIDRxLTEgNC03IDN0LTUtNXExLTUgNi0zdDYgNXogbTM1OCAxNzdxMCAxMTgtODMgMjAydC0yMDIgODQtMjAyLTg0LTg0LTIwMnEwLTkzIDU1LTE2OHQxNDAtMTAzcTEwLTIgMTUgM3Q1IDExcTAgMjktMSA1My0zLTEtOC0ydC0yMC0xLTI3IDMtMjQgMTEtMTcgMjNxLTEzIDMzLTMyIDQxLTEgMS0yIDJsLTUgNXQtMyA1IDIgNCAxMSAycTMgMCA4LTF0MTctOSAxOC0yMHE5LTE1IDIxLTIzdDI0LTggMjIgMiAxNiA1cTQgMjcgMTkgMzktMjggMy00OCAxMHQtNDEgMjItMzEgNDItMTEgNjdxMCA0NCAzMCA3Ny0xNCAzNCAzIDc1IDEwIDQgMzAtNHQzNC0xNmwxNC05cTMzIDkgNzIgOXQ3MS05cTYgNCAxNiAxMHQzMSAxNCAzMiA1cTE2LTQxIDMtNzUgMjktMzMgMjktNzcgMC0zMi04LTU2dC0yMC0zOS0yOS0yNS0zNS0xNC0zOC03cTE5LTE3IDE5LTUzIDAtMjIgMC01MHQtMS0yOHEwLTcgNS0xMXQxNS0zcTg2IDI5IDE0MSAxMDN0NTQgMTY4eiBtMTQzIDI2OHYtNTM2cTAtNjYtNDctMTEzdC0xMTQtNDhoLTUzNXEtNjcgMC0xMTQgNDh0LTQ3IDExM3Y1MzZxMCA2NiA0NyAxMTN0MTE0IDQ4aDUzNXE2NyAwIDExNC00OHQ0Ny0xMTN6IiBob3Jpei1hZHYteD0iODU3LjEiIC8+Cgo8Z2x5cGggZ2x5cGgtbmFtZT0idHdpdHRlci1zcXVhcmVkIiB1bmljb2RlPSImI3hmMzA0OyIgZD0iTTcxNCA1MTBxLTMxLTE0LTY3LTE5IDM4IDIyIDUyIDY1LTM3LTIxLTc1LTI4LTM0IDM2LTg1IDM2LTQ5IDAtODMtMzR0LTM1LTgzcTAtMTYgMy0yNy03MiA0LTEzNSAzN3QtMTA3IDg2cS0xNi0yOC0xNi01OSAwLTY0IDUxLTk4LTI3IDEtNTYgMTV2LTFxMC00MiAyOC03NXQ2OC00MHEtMTYtNS0yOC01LTcgMC0yMiAzIDEyLTM2IDQyLTU5dDY3LTIzcS02NC01MC0xNDUtNTAtMTUgMC0yOCAyIDgyLTUzIDE4MC01MyA2MiAwIDExNyAyMHQ5NCA1MyA2NyA3NiA0MiA5MSAxMyA5NHEwIDEwIDAgMTUgMzUgMjUgNTggNjF6IG0xNDMgMTA4di01MzZxMC02Ni00Ny0xMTN0LTExNC00OGgtNTM1cS02NyAwLTExNCA0OHQtNDcgMTEzdjUzNnEwIDY2IDQ3IDExM3QxMTQgNDhoNTM1cTY3IDAgMTE0LTQ4dDQ3LTExM3oiIGhvcml6LWFkdi14PSI4NTcuMSIgLz4KCjxnbHlwaCBnbHlwaC1uYW1lPSJmYWNlYm9vay1zcXVhcmVkIiB1bmljb2RlPSImI3hmMzA4OyIgZD0iTTY5NiA3NzlxNjcgMCAxMTQtNDh0NDctMTEzdi01MzZxMC02Ni00Ny0xMTN0LTExNC00OGgtMTA0djMzM2gxMTFsMTYgMTI5aC0xMjd2ODNxMCAzMSAxMyA0NnQ1MSAxNmw2OCAxdjExNXEtMzUgNS0xMDAgNS03NSAwLTEyMS00NHQtNDUtMTI3di05NWgtMTEydi0xMjloMTEydi0zMzNoLTI5N3EtNjcgMC0xMTQgNDh0LTQ3IDExM3Y1MzZxMCA2NiA0NyAxMTN0MTE0IDQ4aDUzNXoiIGhvcml6LWFkdi14PSI4NTcuMSIgLz4KPC9mb250Pgo8L2RlZnM+Cjwvc3ZnPg==#fontello) format("svg");font-weight:400;font-style:normal}[class*=" icon-"]:before,[class^=icon-]:before{font-family:fontello;font-style:normal;font-weight:400;speak:none;display:inline-block;text-decoration:inherit;width:1em;margin-right:.2em;text-align:center;-webkit-font-feature-settings:normal;font-feature-settings:normal;font-variant:normal;text-transform:none;line-height:1em;margin-left:.2em;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.icon-twitter:before{content:"\F099"}.icon-github-circled:before{content:"\F09B"}.icon-facebook-official:before{content:"\F230"}.icon-github-squared:before{content:"\F300"}.icon-twitter-squared:before{content:"\F304"}.icon-facebook-squared:before{content:"\F308"}</style></head><body><div id="___gatsby"><div style="max-width:42rem;margin-left:auto;margin-right:auto;padding:2.625rem 1.3125rem;" data-reactroot="" data-reactid="1" data-react-checksum="170474256"><h3 style="font-family:Montserrat, sans-serif;margin-top:0;margin-bottom:-1.75rem;" data-reactid="2"><a style="box-shadow:none;text-decoration:none;color:inherit;" href="/" data-reactid="3">5π - fish&#x27;s blog</a></h3><div data-reactid="4"><!-- react-empty: 5 --><h1 data-reactid="6">Production Grade Kubernetes</h1><p style="font-size:0.83255rem;line-height:1.75rem;display:block;margin-bottom:1.75rem;margin-top:-1.75rem;" data-reactid="7">2017-12-15T14:08:29.000Z</p><div data-reactid="8"><p><a href="a%0Ahref=%22https://www.researchgate.net/304012394_fig1_Fig-1-The-seakeeping-coordinate-system%22">a
href=“https://www.researchgate.net/304012394<em>fig1</em>Fig-1-The-seakeeping-coordinate-system”</a><img src="https://www.researchgate.net/profile/Zhaolong_Yu/publication/304012394/figure/fig1/AS:373636524462081@1466093297802/Fig-1-The-seakeeping-coordinate-system.ppm" alt="Fig. 1 The seakeeping coordinate system"></a></p>
<p>About a year ago I blogged about how to build a <a href="/2016/11/20/15-producation-grade-kubernetes-cluster/">$15 Production Kubernetes
Cluster on DigitalOcean</a>
and submitted it to <a href="https://news.ycombinator.com/">Hacker News</a>.</p>
<p>HN being HN, soon after these comments trickled in:</p>
<p>
  <a
    class="gatsby-resp-image-link"
    href="/static/hn-comment-acfed1c5b7512a39140c4288b9d642b6-26951.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
  
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; ; max-width: 560px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 20.357142857142858%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAhklEQVQI14WPXQtEQBSG/f//o43sTBhGalKkXLCLwazWmPJ1bWo0d1LPqfN2eus5xnEIxbpOErXv+7xtXJ/uMJqmFOLXdZ9hqMeRtm3Z919KK87Zc1nOsvxt2/S8d5YRjF3HeRVFCoBFCA4CGEU+QiDPkzhGMkJohaHLWH2VNUpVC9+Z6+9OiUjZql2aPVcAAAAASUVORK5CYII='); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"
        alt="What people call production nowadays... - pst"
        title=""
        src="/static/hn-comment-acfed1c5b7512a39140c4288b9d642b6-26951.png"
        srcset="/static/hn-comment-acfed1c5b7512a39140c4288b9d642b6-b2ad5.png 148w,
/static/hn-comment-acfed1c5b7512a39140c4288b9d642b6-2283b.png 295w,
/static/hn-comment-acfed1c5b7512a39140c4288b9d642b6-26951.png 560w"
        sizes="(max-width: 560px) 100vw, 560px"
      />
    </span>
  </span>
  
  </a>
    .</p>
<p>Fair enough. If you only need $15 worth of resources, running a three node
Kubernetes cluster might not be the best idea. As explained in that article, I
was more referring to the way it’s deployed:</p>
<ul>
<li>Highly available: Clustered etcd, multiple master/controller instances</li>
<li>Secure: TLS for etcd clients and peers and apiserver+kubelet</li>
</ul>
<p>Personally I built it mainly to have a Kubernetes playground. But in the
meanwhile I founded <a href="https://latency.at">Latency.at</a>. It’s a service to measures
performance and availability of sites and services from multiple global
locations and provides the results as Prometheus metrics. And of course it’s
running on Kubernetes, so I didn’t have the need for a playground and migrated
this blog to <a href="https://github.com/gatsbyjs/gatsby">Gatsby.js</a>.</p>
<p>I’m also <a href="/hire-me/">consulting</a> people on, among other things, how to build
production grade Kubernetes infrastructure. For this I looked into various way
to deploy Kubernetes today. There are <em>many</em> and most claimed to be “production
grade”:</p>
<ul>
<li><a href="https://github.com/kubernetes/kops">https://github.com/kubernetes/kops</a></li>
<li><a href="https://github.com/coreos/tectonic-installer">https://github.com/coreos/tectonic-installer</a></li>
<li><a href="https://github.com/aws-quickstart/quickstart-heptio">https://github.com/aws-quickstart/quickstart-heptio</a></li>
<li><a href="https://github.com/kubernetes-incubator/kube-aws">https://github.com/kubernetes-incubator/kube-aws</a></li>
<li><a href="https://github.com/kubernetes-incubator/kubespray">https://github.com/kubernetes-incubator/kubespray</a></li>
<li><a href="https://kubernetes.io/docs/setup/independent/create-cluster-kubeadm/">https://kubernetes.io/docs/setup/independent/create-cluster-kubeadm/</a></li>
</ul>
<h3>Highly available?</h3>
<p>In my book, having a highly available cluster is a strict requirement for
production deployments. You might have specialized use case where this isn’t
necessary but if you run realtime, business critical applications this is a
requirement.</p>
<p>While an outage of the controller components won’t affect running applications,
you can’t operate the cluster anymore: If your ingress controller gets restarted
during that time, it won’t know about your backends. If an important pod dies,
nobody will restart it.</p>
<p>This requirement already rules out one of the most popular options:
<a href="https://kubernetes.io/docs/setup/independent/create-cluster-kubeadm/">kubeadm</a>.
At least it doesn’t claim to be stable yet and everything except this looks very
promising.</p>
<p>The same limitation applies to projects built upon kubeadm, like
<a href="https://github.com/kris-nova/kubicorn">kubicorn</a> and the <a href="https://github.com/aws-quickstart/quickstart-heptio">hepio cloudformation
templates</a>.</p>
<h3>Secure?</h3>
<p>A Kubernetes cluster can be “(in)secure” on multiple layers. First etcd should
require peers and client certificates to be signed by a trusted CA. Next the
apiserver needs to verify that the certificate of the etcd endpoint it connects
to is signed by a trusted CA, as well as certificates of clients connecting to
the apiserver. Now the kubelet connecting to the apiserver needs to validate
that certificate too.</p>
<p>Beside the transport level security provided by TLS, Kubernetes supports RBAC to
limit the access pods in the cluster have to the Kubernetes API. This needs to
be enabled too.</p>
<p>Again, in my option all these are production requirements. Keep in mind that
just the ability to run a privileged container or mount a volume is enough to
compromise your infrastructure. This can be done on each of these layers with
different effort. Not require TLS on any connection should be consider missing
no authentication at all.</p>
<p>There are setups which don’t require etcd TLS but limit it’s reachability to
controller nodes, then using tains to prevent “untrusted” containers to get
scheduled on the masters. While this is better than nothing, it’s still a risk
not worth taking.</p>
<p>Unfortunately none of the more light-weight options fulfill these requirements.
Frankly, there are so many ‘installers’ out there, I can’t say this for sure but
the most popular options like kops are lacking. When running with calico
networking, it even requires etcd to be writable from all nodes without
authentication. Other options like kubespray don’t support full TLS either. Not
even the tectonic-installer, which in general looks very promising, supports TLS
out the box by default.</p>
<h3>(Self-)Sufficiency?</h3>
<p>The most common Kubernetes setups are not self-sufficient but depend often on
multiple external Docker registries and components during runtime. Since usually
these are referred to by mutable tags, there is also no way to guarantee that
nobody changes a dependency without you noticing.
Unfortunately this is something rarely discussed and there isn’t any
light-weight tooling I came across helping with this.</p>
<h3>Conclusion</h3>
<p>I can’t claim I looked into every Kubernetes installer project and ignored
complex “enterprise” stacks like <a href="http://www.projectatomic.io">Red Hat’s Atomic</a>
or <a href="https://jujucharms.com/canonical-kubernetes/">Canonical Kubernetes Juju</a> but
I’m surprised how many different options there are, yet how few of them provide
what I’m looking for: A simple, immutable, secure and available cluster.</p>
<p>As of right now, the
<a href="https://github.com/coreos/tectonic-installer">tectonic-installer</a> looks like
the best option, especially if you need to deploy on bare metal or openstack.
But it’s a fast moving project and it could become a drag to keep up with
upstream changes. Another thing leaving a bad taste is that the component for
automated updates is closed source and not available for free.</p>
<p><a href="https://github.com/kubernetes/kubeadm/issues/261">kubeadm works on HA</a> but I
wouldn’t be surprised if it takes another year until this works reliably.
Fortunately you can build upon kubeadm to create secure and HA clusters. Since
this, to me, appears to be the best option, I implemented this based on
cloudformation for AWS for one of my clients. Hopefully I can share the results
as open source soon. For now you can find valuable hints on <a href="https://github.com/kubernetes/kubeadm/issues/546">this GitHub
issue</a>.</p>
<p>But should you even run your own Kubernetes cluster? Probably not! Kubernetes is
a incredibly fast moving project. As a rule of thumb, I’d say operating a
Kubernetes cluster is a full time job. Don’t assume any of the installers will
free you from developing a deep understanding of Kubernetes’ internals. If you
operate your own cluster, be prepared to read source code and fix bugs yourself.
This is especially true with all the managed solutions and <a href="https://cloud.google.com/kubernetes-engine/">Google Kubernetes
Engine</a> now being available for
free.</p></div><hr style="margin-bottom:1.75rem;" data-reactid="9"/><div style="display:flex;margin-bottom:4.375rem;" data-reactid="10"><img src="/static/profile-pic.c22be3bb.jpg" alt="Johannes Ziemke" style="margin-right:0.875rem;margin-bottom:0;width:3.5rem;height:3.5rem;" data-reactid="11"/><p data-reactid="12"><!-- react-text: 13 -->By <!-- /react-text --><strong data-reactid="14">Johannes Ziemke</strong><!-- react-text: 15 -->.<!-- /react-text --><!-- react-text: 16 --> <!-- /react-text --><br data-reactid="17"/><!-- react-text: 18 -->You can <!-- /react-text --><strong data-reactid="19"><a href="/hire-me" data-reactid="20">hire me</a></strong><!-- react-text: 21 -->.<!-- /react-text --></p><span style="margin-left:auto;" data-reactid="22"><a href="https://twitter.com/discordianfish" data-reactid="23"><i class="icon-twitter" data-reactid="24"></i></a><a href="https://github.com/discordianfish" data-reactid="25"><i class="icon-github-circled" data-reactid="26"></i></a></span></div><ul style="display:flex;flex-wrap:wrap;justify-content:space-between;list-style:none;padding:0;" data-reactid="27"><li data-reactid="28"><a rel="prev" href="/2017/11/09/use-prometheus-vector-matching-to-get-kubernetes-utilization-across-any-pod-label/" data-reactid="29"><!-- react-text: 30 -->← <!-- /react-text --><!-- react-text: 31 -->Use Prometheus Vector Matching to get Kubernetes Utilization across any Pod Label<!-- /react-text --></a></li></ul></div><span style="display:block;clear:both;" data-reactid="32"> </span></div></div><script id="webpack-manifest">/*<![CDATA[*/window.webpackManifest={"231608221292675":"app-25f1fe20b777aed8076d.js","99219681209289":"component---node-modules-gatsby-plugin-offline-app-shell-js-5c4c5a0f7af9dc69d6d7.js","107818501498521":"component---src-templates-blog-post-js-036753d74d89fd51a17f.js","35783957827783":"component---src-pages-index-js-78b457eb328f2564ac7a.js","60335399758886":"path----1ffe6c03441b7b427cb3.js","210333531512890":"path---offline-plugin-app-shell-fallback-a0e39f21c11f6a62c5ab.js","214880966025118":"path---2017-12-15-production-grade-kubernetes-1d4543bbf55aba20ee23.js","263596615691880":"path---2017-11-09-use-prometheus-vector-matching-to-get-kubernetes-utilization-across-any-pod-label-4ff17ae30fb9d4ae65e0.js","33143188725548":"path---2017-04-17-selenium-webdriver-chromedriver-nightwatch-chrome-headless-a9b0c003849a2557274b.js","162183589928130":"path---2016-11-20-15-producation-grade-kubernetes-cluster-2a3da9cf68861a528940.js","41627737030171":"path---2015-10-05-the-future-fabrication-cloud-81473bd20e2f1d1773b6.js","74228480928951":"path---2015-10-02-the-future-29d28089d2717a48ccb8.js","229428869920157":"path---2015-09-02-uploaded-thousands-of-photos-to-google-photos-here-are-the-best-classification-mistakes-628c3a39052cc23cd60c.js","173914803063736":"path---2015-08-31-dont-manage-config-unless-you-have-to-a1389a0b9a5fab0c259a.js","21869895544540":"path---2015-04-27-cloudformation-driven-consul-in-autoscalinggroup-d094b23f5ee3c9a7bdd3.js","23322709388340":"path---2015-04-22-scope-and-ownership-in-tech-companies-72f7f9fc974f298fe46f.js","200459074764225":"path---2015-03-13-building-aws-amis-from-scratch-493450ad67f64a18aa62.js","266226263243380":"path---2015-02-10-prometheus-on-raspberry-pi-a6072ee2d12cfe43e870.js","114328391656268":"path---2015-01-27-find-ghosts-in-your-docker-images-0545e7f7dfe1ee32bc3e.js","119570531827300":"path---2015-01-26-monitor-docker-containers-with-prometheus-80760b700a0976e9fcfc.js","7844381199199":"path---2015-01-08-containerized-infrastructure-039e01d386f129cf77f6.js","48650439439500":"path---2014-11-13-using-docker-run-netcontainerxx-to-debug-network-issues-c7c76d16a2cf09764a63.js","228256526782408":"path---2014-11-10-running-a-highly-available-load-balancer-on-docker-f4b88788c8f8ebf4aa9e.js","273472638405565":"path---hire-me-d231c7d0c108bb0d5d84.js","142629428675168":"path---index-82ff3f270e179e1b68a3.js","114276838955818":"component---src-layouts-index-js-bb0078f6fed199dc13ad.js"}/*]]>*/</script><script>
  
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-22856766-3', 'auto');
  </script><script>/*<![CDATA[*/!function(e,t,r){function n(){for(;d[0]&&"loaded"==d[0][f];)c=d.shift(),c[o]=!i.parentNode.insertBefore(c,i)}for(var s,a,c,d=[],i=e.scripts[0],o="onreadystatechange",f="readyState";s=r.shift();)a=e.createElement(t),"async"in i?(a.async=!1,e.head.appendChild(a)):i[f]?(d.push(a),a[o]=n):e.write("<"+t+' src="'+s+'" defer></'+t+">"),a.src=s}(document,"script",["/commons-3cf304937523a964e309.js","/app-25f1fe20b777aed8076d.js","/path---2017-12-15-production-grade-kubernetes-1d4543bbf55aba20ee23.js","/component---src-templates-blog-post-js-036753d74d89fd51a17f.js","/component---src-layouts-index-js-bb0078f6fed199dc13ad.js"])/*]]>*/</script></body></html>